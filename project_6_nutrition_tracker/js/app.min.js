var FoodAttributes=Backbone.Model.extend({defaults:{item_name:"",brand_name:"",nf_serving_size_qty:null,nf_calories:null}}),GetFoodObjects=Backbone.Collection.extend({initialize:function(a,b){this.id=b.id},url:function(){return"https://api.nutritionix.com/v1_1/search/"+this.id+"?results=0:20&fields=item_name,brand_name,nf_serving_size_qty,nf_calories&appId=8413e82a&appKey=0142fcf7e19fb339a900d4b1d05135ae"},parse:function(a){return a.hits}}),HoldFoodEntries=Backbone.Collection.extend({model:FoodAttributes}),HoldSearchResults=Backbone.Collection.extend({model:FoodAttributes}),ButtonDisplay=Backbone.View.extend({el:".row1",events:{"click button#newEntryButton":"renderSearchBox"},renderSearchBox:function(){$("#newEntryCSS").removeClass("hidden")}}),GetFoodSearchResult=Backbone.View.extend({getEntryInput:function(a){a.preventDefault();var b=$("#searchFood input:first-child").val();this.getResults(b)},getResults:function(a){holdSearchResults.reset();var b=new GetFoodObjects([],{id:a});b.fetch({beforeSend:function(){showSearchResults.renderLoadingGIF()},success:function(a){_.each(a.toJSON(),function(a){holdSearchResults.add(new FoodAttributes({item_name:a.fields.item_name,brand_name:a.fields.brand_name,nf_serving_size_qty:a.fields.nf_serving_size_qty,nf_calories:a.fields.nf_calories}))}),showSearchResults.render()},error:function(){showSearchResults.renderError()}})}}),NewEntryControl=Backbone.View.extend({el:"#newEntryCSS",events:{"click .actionButtonBackground":"hideSearchBox","submit #searchFood":"hideSearchBox"},hideSearchBox:function(a){getFoodSearchResult.getEntryInput(a),$("#newEntryCSS").addClass("hidden")}}),ShowSearchResults=Backbone.View.extend({el:"#resultsContainer",events:{"click button.add":"addToLog"},initialize:function(){_.bindAll(this,"render"),this.resultsDiv=$("#resultsContainer"),this.collection=holdSearchResults},render:function(){var a=this.resultsDiv,b=this.collection.toJSON(),c=_.template($("#searchResultsTemplate").html());a.empty(),_.each(b,function(b){var d=c(b);a.append(d)})},renderError:function(){var a=this.resultsDiv;a.empty(),a.append("<h4>Sorry! No item found</h4>")},renderLoadingGIF:function(){var a=$("#loadingIcon");a.removeClass("hidden")},addToLog:function(a){var b=this.resultsDiv,c=a.currentTarget.parentNode.parentNode,d=c.getElementsByClassName("ItemName")[0].textContent,e=c.getElementsByClassName("ItemBrand")[0].textContent,f=c.getElementsByClassName("ItemCalories")[0].textContent,g=c.getElementsByClassName("ItemSrvSize")[0].textContent;holdFoodEntries.add(new FoodAttributes({item_name:d,brand_name:e,nf_serving_size_qty:g,nf_calories:f})),b.empty()}}),ShowFoodEntries=Backbone.View.extend({el:"#foodLogDynamic",events:{"click button.delete":"deleteEntry"},initialize:function(){this.counter=$("#calorieCounter h3"),_.bindAll(this,"render"),this.collection=holdFoodEntries,this.listenTo(this.collection,"add",this.render)},render:function(){var a=this;$(this.el).empty();var b=this.collection.toJSON(),c=_.template($("#entriesTemplate").html());_.each(b,function(b){var d=c(b);$(a.el).append(d)}),this.updateCounter()},deleteEntry:function(a){var b=a.currentTarget.parentNode.parentNode,c=b.getElementsByClassName("ItemName")[0].textContent,d=holdFoodEntries.findWhere({item_name:c});holdFoodEntries.remove(d),this.render(),this.updateCounter()},updateCounter:function(){var a=this.collection.pluck("nf_calories"),b=[],c=0;_.each(a,function(a){var c=a.slice(10);b.push(parseInt(c,10))}),_.each(b,function(a){c+=a}),this.counter.text("Total Calories: "+c)}}),Router=Backbone.Router.extend({routes:{"":"home"}}),holdFoodEntries=new HoldFoodEntries,holdSearchResults=new HoldSearchResults,buttonDisplay=new ButtonDisplay,newEntryControl=new NewEntryControl,getFoodSearchResult=new GetFoodSearchResult,showSearchResults=new ShowSearchResults,showFoodEntries=new ShowFoodEntries,router=new Router;router.on("route:home",function(){}),Backbone.history.start();